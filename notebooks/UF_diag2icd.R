#' Get ICD codes using diagnoses
#'
#' This function queries the CDM database using diagnosis and outputs their known ICD codes.
#' By providing the name of the diagnoses in the form of a string (single) or
#' a vector of strings (multiple), we are able to provide the associated ICD codes
#' of these diagnoses from ICD 9 and 10 in the form of a vector of strings.
#' Current covered diagnoses:
#' 1) Major Depressive Disorder ('mdd')
#' 2) Bipolar and Related Disorders ('bipolar')
#' 3) Anxiety Disorders ('anxiety')
#' 4) Trauma and Stressor Related Disorders ('trauma')
#' 5) Substance Related and Addictive Disorders ('substance')
#' 6) Schizophrenia Spectrum and Other Psychotic Disorders ('schiz')
#' Assumptions: None.
#' @param diag A string or a vector of strings containing diagnosis keywords 'mdd', 'bipolar', 'anxiety', 'trauma', 'substance', 'schiz'
#' @param con Connection to the database, default = conn() that has to be run before running this function.
#' @keywords ICD; concept ID; ICD descriptions
#' @returns A dataframe containing the concept ID, concept name and ICD codes queried.
#' @export
#' @examples
#' diag2ICD('mdd')
#' #[1] "F32.4"  "F33.3"  "F33.9"  "F33.42" "F33.41" "F33.2"  "F33.1"  "F33.0"  "F32.9"  "F32.5"  "F32.3"  "F32.2"  "F32.1"  "F32.0"  "296.36"
#' #[16] "296.35" "296.34" "296.33" "296.32" "296.31" "296.30" "296.26" "296.25" "296.24" "296.23" "296.22" "296.21" "296.20"
#' diag2ICD(c('mdd', 'schiz'))
#' > diag2ICD(c('mdd', 'schiz'))
#' #[1] "F32.4"  "F33.3"  "F33.9"  "F33.42" "F33.41" "F33.2"  "F33.1"  "F33.0"  "F32.9"  "F32.5"  "F32.3"  "F32.2"  "F32.1"  "F32.0"  "296.36"
#' #[16] "296.35" "296.34" "296.33" "296.32" "296.31" "296.30" "296.26" "296.25" "296.24" "296.23" "296.22" "296.21" "296.20" "297.3"  "293.82"
#' #[31] "293.89" "295.10" "295.20" "F25.1"  "298.9"  "298.8"  "293.81" "297.1"  "295.90" "295.70" "295.60" "295.40" "295.30" "F28"    "F29"
#' #[46] "F20.81" "F20.9"  "F06.0"  "F06.1"  "F06.2"  "F22"    "F23"    "F25.0"

diag2ICD <- function(diag) {
  # accepts a diagnosis ['mdd', 'bipolar', 'anxiety', 'trauma', 'substance', 'schiz' ]
  # outputs ICD codes
    icd <- c()
    if ('mdd' %in% diag) {# mdd
      mdd <- c('F32.4', 'F33.3', 'F33.9', 'F33.42', 'F33.41', 'F33.2',
               'F33.1', 'F33.0', 'F32.9', 'F32.5', 'F32.3', 'F32.2',
               'F32.1', 'F32.0', '296.36', '296.35', '296.34', '296.33',
               '296.32', '296.31', '296.30', '296.26', '296.25', '296.24',
               '296.23', '296.22', '296.21', '296.20')
      icd <- c(icd, mdd)
      }

    if ("bipolar" %in% diag) { # bipolar and related
      bipolar <- c('F31.73', 'F31.74', 'F31.75', '296.80', '296.7', '296.66',
               'F31.76', 'F31.81', 'F31.89', 'F31.9', '296.00', '296.01',
               '296.02', '296.03', '296.04', '296.05', '296.06', 'F06.34',
               'F06.33', 'F31.0', 'F31.11', 'F31.12', 'F31.13', '296.40',
               '296.42', '296.41', '296.43', '296.44', '296.45', '296.46',
               '296.50', '296.51', '296.52', '296.53', '296.54', '296.55',
               '296.56', '296.60', '296.61', '296.62', '296.63', '296.64',
               '296.65', 'F31.2', 'F31.31', 'F31.32', 'F31.4', 'F31.5',
               '301.13', 'F34.0', 'F31.71', 'F31.72', '296.89')
      icd <- c(icd, bipolar)
      }

    if ("anxiety" %in% diag) { # anxiety disorders
      anxiety <- c('F40.228', '300.02', '309.21', 'F40.233', 'F40.248',
               '300.01', 'F40.218', 'F94.0', 'F93.0', '293.84', '300.00',
               'F40.230', 'F40.298', 'F41.0', 'F41.1', 'F41.9', 'F41.8',
               'F40.231', 'F40.10', 'F40.00', 'F06.4', 'F40.232', '313.23',
               '300.29', '300.23', '300.22', '300.21', '300.09')
      icd <- c(icd, anxiety)
      }

    if ("trauma" %in% diag) { # trauma & stressor disorders
      trauma <- c('F94.1', 'F43.21', 'F43.20', 'F43.10', 'F43.0', 'F94.2',
               'F43.9', 'F43.8', 'F43.25', 'F43.24', '308.3', '309.0',
               '309.24', 'F43.23', 'F43.22', '309.28', '309.3', '309.4',
               '309.81', '309.89', '309.9', '313.89')
      icd <- c(icd, trauma)
      }

    if ("substance" %in% diag) { # substance related & additive disorders
      substance <- c('292.81', '292.12', '292.11', '292.0', '291.9', '291.89',
               '291.82', '291.81', '291.5', '291.3', '291.2', '291.1',
               '291.0', 'F14.14', 'F14.180', 'F14.181', 'F14.182', 'F14.188',
               'F14.20', 'F14.21', 'F14.221', 'F14.222', 'F14.229', 'F14.23',
               'F14.24', 'F14.259', 'F14.280', 'F14.281', 'F14.282', 'F14.288',
               'F14.921', 'F14.922', 'F14.929', 'F14.94', 'F14.959', 'F14.980',
               'F14.981', 'F14.982', 'F14.988', 'F14.99', 'F15.10', 'F15.11',
               'F15.121', 'F15.122', 'F15.129', 'F15.14', 'F15.159', 'F15.180',
               'F15.181', 'F15.182', 'F15.188', 'F15.20', 'F15.21', 'F15.221',
               'F15.222', 'F15.229', 'F15.23', 'F15.24', 'F15.259', 'F15.280',
               'F15.281', 'F15.282', 'F15.288', 'F15.921', 'F15.922', 'F15.929',
               'F15.93', 'F15.94', 'F15.959', 'F15.980', 'F15.981', 'F15.982',
               'F15.988', 'F15.99', 'F16.10', 'F16.11', 'F16.121', 'F16.129',
               'F16.14', 'F16.159', 'F16.180', 'F16.20', 'F16.21', 'F16.221',
               'F16.229', 'F16.24', 'F16.259', 'F16.280', 'F16.921', 'F16.929',
               'F16.94', 'F16.959', 'F16.980', 'F16.983', 'F16.99', 'F17.200',
               'F17.201', 'F17.203', 'F17.208', 'F17.209', 'F18.10', 'F18.11',
               'F18.121', 'F18.129', 'F18.14', 'F18.159', 'F18.17', 'F18.180',
               'F18.188', 'F18.20', 'F18.21', 'F18.221', 'F18.229', 'F18.24',
               'F18.259', 'F18.27', 'F18.280', 'F18.288', 'F18.921', 'F18.929',
               'F18.94', 'F18.959', 'F18.97', 'F18.980', 'F18.988', 'F18.99',
               'F19.10', 'F19.11', 'F19.121', 'F19.129', 'F19.14', 'F19.159',
               'F19.17', 'F19.180', 'F19.181', 'F19.182', 'F19.188', 'F19.20',
               'F19.21', 'F19.221', 'F19.229', 'F19.231', 'F19.239', 'F19.24',
               'F19.259', 'F19.27', 'F19.280', 'F19.281', 'F19.282', 'F19.288',
               'F19.921', 'F19.929', 'F19.939', 'F19.94', 'F19.959', 'F19.97',
               'F19.980', 'F19.981', 'F19.982', 'F19.988', 'F19.99', '312.31',
               '305.90', '305.70', '305.60', '305.50', '305.40', '305.30',
               '305.20', '305.1', '305.00', '304.90', '304.80', '304.60',
               '304.50', '304.40', '304.30', '304.20', '304.10', '304.00',
               '303.90', '303.00', 'F63.0', '292.9', '292.89', '292.85',
               '292.84', '292.83', '292.82', 'F12.20', 'F12.21', 'F12.221',
               'F12.222', 'F12.229', 'F12.23', 'F12.259', 'F12.280', 'F12.288',
               'F12.921', 'F12.922', 'F12.929', 'F12.93', 'F12.959', 'F12.980',
               'F12.988', 'F12.99', 'F13.10', 'F13.11', 'F13.121', 'F13.129',
               'F13.14', 'F13.159', 'F13.180', 'F13.181', 'F13.182', 'F13.20',
               'F13.21', 'F13.221', 'F13.229', 'F13.231', 'F13.232', 'F13.239',
               'F13.24', 'F13.259', 'F13.27', 'F13.280', 'F13.281', 'F13.282',
               'F13.288', 'F13.921', 'F13.929', 'F13.931', 'F13.932', 'F13.939',
               'F13.94', 'F13.959', 'F13.97', 'F13.980', 'F13.981', 'F13.982',
               'F13.988', 'F13.99', 'F14.10', 'F14.11', 'F14.121', 'F14.122',
               'F14.129', 'F14.159', 'F10.10', 'F10.11', 'F10.121', 'F10.129',
               'F10.14', 'F10.159', 'F10.180', 'F10.181', 'F10.182', 'F10.20',
               'F10.21', 'F10.221', 'F10.229', 'F10.231', 'F10.232', 'F10.239',
               'F10.24', 'F10.259', 'F10.26', 'F10.27', 'F10.280', 'F10.281',
               'F10.282', 'F10.288', 'F10.921', 'F10.929', 'F10.94', 'F10.959',
               'F10.96', 'F10.97', 'F10.980', 'F10.981', 'F10.982', 'F10.988',
               'F10.99', 'F11.10', 'F11.11', 'F11.121', 'F11.122', 'F11.129',
               'F11.14', 'F11.181', 'F11.182', 'F11.188', 'F11.20', 'F11.21',
               'F11.221', 'F11.222', 'F11.229', 'F11.23', 'F11.24', 'F11.281',
               'F11.282', 'F11.288', 'F11.921', 'F11.922', 'F11.929', 'F11.93',
               'F11.94', 'F11.981', 'F11.982', 'F11.988', 'F11.99', 'F12.10',
               'F12.11', 'F12.121', 'F12.122', 'F12.129', 'F12.159', 'F12.180',
               'F12.188')
      icd <- c(icd, substance)
      }

    if ("schiz" %in% diag) { #schizophrenia spectrum & other psychotic disorders
      schiz <- c('297.3', '293.82', '293.89', '295.10', '295.20', 'F25.1',
               '298.9', '298.8', '293.81', '297.1', '295.90', '295.70',
               '295.60', '295.40', '295.30', 'F28', 'F29', 'F20.81',
               'F20.9', 'F06.0', 'F06.1', 'F06.2', 'F22', 'F23', 'F25.0')
      icd <- c(icd, schiz)
      }
  return(icd)
}
